import{a as g,r as o,j as e,C as S,V as L,H as d,B as M,b as l,I as N,S as b,d as u,e as w,L as q,c as $}from"./index-BFw5mKhb.js";import{u as k}from"./useQuery-Dqc1InEi.js";import{u as A}from"./mappers-Et_TSE1t.js";import{u as B}from"./useContactListService-BXRVcd0O.js";import{u as D}from"./useContactService-BUIZEp1O.js";const H=()=>{const h=g(),{fetchContacts:x}=B(),{deleteContact:j}=D(),{data:n,isLoading:m}=k({queryKey:["contacts"],queryFn:x}),i=o.useMemo(()=>(n==null?void 0:n.contacts)??[],[n]),[r,p]=o.useState(""),[s,y]=o.useState(),c=A({mutationFn:j,onSuccess:()=>{h.invalidateQueries({queryKey:["contacts"]})}}),C=(t,a)=>{confirm(`Are you sure you want to delete ${a}?`)&&c.mutate(t)},v=o.useMemo(()=>i.filter(t=>{const a=r?t.firstName.toLowerCase().includes(r.toLowerCase())||t.lastName.toLowerCase().includes(r.toLowerCase()):!0,f=s?t.preferredMethod===s:!0;return a&&f}),[i,r,s]);return e.jsx(S,{children:e.jsxs(L,{gap:3,children:[e.jsxs(d,{children:[e.jsx("h1",{children:"Contacts"}),e.jsxs(M,{children:[i.length," total"]})]}),e.jsx(l,{children:e.jsxs(d,{wrap:!0,gap:2,children:[e.jsx(N,{placeholder:"Search name or handle…",value:r,onChange:t=>p(t.target.value)}),e.jsxs(b,{value:s==null?void 0:s.value,onChange:t=>{const a=t.target.value;y(a?u.tryFromValue(a):void 0)},children:[e.jsx("option",{value:"",children:"All channels"}),u.toOptions().map(t=>e.jsx("option",{value:t.value,children:t.label}))]})]})}),m?e.jsx(l,{children:"Loading…"}):e.jsx(l,{children:e.jsxs(w,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Preferred Method"}),e.jsx("th",{children:"Interval"}),e.jsx("th",{style:{width:1},children:"Actions"})]})}),e.jsx("tbody",{children:v.map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx(q,{to:`/contacts/${t.id}`,children:`${t.firstName} ${t.lastName}`})}),e.jsx("td",{children:t.preferredMethod.display}),e.jsxs("td",{children:[t.intervalDays," days"]}),e.jsx("td",{children:e.jsx($,{variant:"secondary",size:"sm",onClick:()=>C(t.id,`${t.firstName} ${t.lastName}`),disabled:c.isPending,children:"Delete"})})]},t.id))})]})})]})})};export{H as Contacts};
