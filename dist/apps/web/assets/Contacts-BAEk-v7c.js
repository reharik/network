import{a as g,r as o,j as e,C as S,V as L,H as l,B as M,b as c,I as N,S as b,d as h,e as w,L as q,c as $}from"./index-9bKELV1L.js";import{u as k}from"./useQuery-Cz8LaG0o.js";import{u as A}from"./useMutation-DOcVeEDd.js";import{u as B}from"./useContactListService-G9c6mWme.js";import{u as D}from"./useContactService-BPabvCE3.js";const H=()=>{const u=g(),{fetchContacts:x}=B(),{deleteContact:j}=D(),{data:s,isLoading:m}=k({queryKey:["contacts"],queryFn:x}),i=o.useMemo(()=>s!=null&&s.success&&(s!=null&&s.data.contacts)?s==null?void 0:s.data.contacts:[],[s]),[r,p]=o.useState(""),[a,y]=o.useState(),d=A({mutationFn:j,onSuccess:()=>{u.invalidateQueries({queryKey:["contacts"]})}}),C=(t,n)=>{confirm(`Are you sure you want to delete ${n}?`)&&d.mutate(t)},v=o.useMemo(()=>i.filter(t=>{const n=r?t.firstName.toLowerCase().includes(r.toLowerCase())||t.lastName.toLowerCase().includes(r.toLowerCase()):!0,f=a?t.preferredMethod===a:!0;return n&&f}),[i,r,a]);return e.jsx(S,{children:e.jsxs(L,{gap:3,children:[e.jsxs(l,{children:[e.jsx("h1",{children:"Contacts"}),e.jsxs(M,{children:[i.length," total"]})]}),e.jsx(c,{children:e.jsxs(l,{wrap:!0,gap:2,children:[e.jsx(N,{placeholder:"Search name or handle…",value:r,onChange:t=>p(t.target.value)}),e.jsxs(b,{value:a==null?void 0:a.value,onChange:t=>{const n=t.target.value;y(n?h.tryFromValue(n):void 0)},children:[e.jsx("option",{value:"",children:"All channels"}),h.toOptions().map(t=>e.jsx("option",{value:t.value,children:t.label}))]})]})}),m?e.jsx(c,{children:"Loading…"}):e.jsx(c,{children:e.jsxs(w,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Preferred Method"}),e.jsx("th",{children:"Interval"}),e.jsx("th",{style:{width:1},children:"Actions"})]})}),e.jsx("tbody",{children:v.map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx(q,{to:`/contacts/${t.id}`,children:`${t.firstName} ${t.lastName}`})}),e.jsx("td",{children:t.preferredMethod.display}),e.jsxs("td",{children:[t.intervalDays," days"]}),e.jsx("td",{children:e.jsx($,{variant:"secondary",size:"sm",onClick:()=>C(t.id,`${t.firstName} ${t.lastName}`),disabled:d.isPending,children:"Delete"})})]},t.id))})]})})]})})};export{H as Contacts};
